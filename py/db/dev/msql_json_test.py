from sqlalchemy import create_engine
import random
from sqlalchemy.sql import text
import orjson
import time
import copy


def dump_data(father, key):
    if isinstance(father[key], dict):
        for child_key in father[key].keys():
            dump_data(father[key], child_key)
    elif isinstance(father[key], list):
        father[key] = data


def assign_keys(father, key):
    key_list = []
    for child_key in father[key].keys():
        if isinstance(father[key][child_key], list):
            key_list.append(child_key)
        elif isinstance(father[key][child_key], dict):
            assign_keys(father[key], child_key)
    if len(key_list) != 0:
        father[key] = key_list


def extract_keys(dic):
    key_dic = copy.deepcopy(dic)
    for key in dic.keys():
        assign_keys(key_dic, key)
    return key_dic


META_URL = "mysql://root:8315814@127.0.0.1:3306/demo?charset=utf8"
meta_engine = create_engine(META_URL, encoding="utf-8", pool_pre_ping=True)

json_data = {
    "泵驱动端": {
        "水平方向": {
            # '前期_01': {
            #     '频域': {
            #         'αFmax_1000': [],
            #         'αFmax_5000': [],
            #         'αFmax_400': [],
            #         'vFmax_1600': [],
            #         'vHF_10k_Fmax_1000': [],
            #         'αHF_10k_Fmax_1000': [],
            #         '解调HF_10k_Fmax_1000': [],
            #         '解调HF_1-10k_Fmax_1000': [],
            #     },
            #     '时域': {
            #         'αFmax_1000': [],
            #         'αFmax_5000': [],
            #         'αFmax_400': [],
            #         'vFmax_1600': [],
            #         'vHF_10k_Fmax_1000': [],
            #         'αHF_10k_Fmax_1000': [],
            #         '解调HF_10k_Fmax_1000': [],
            #         '解调HF_1-10k_Fmax_1000': [],
            #     },
            # },
            # '前期_02': {
            #     '频域': {
            #         'αFmax_1000': [],
            #         'αFmax_5000': [],
            #         'αFmax_400': [],
            #         'vFmax_1600': [],
            #         'vHF_10k_Fmax_1000': [],
            #         'αHF_10k_Fmax_1000': [],
            #         '解调HF_10k_Fmax_1000': [],
            #         '解调HF_1-10k_Fmax_1000': [],
            #     },
            #     '时域': {
            #         'αFmax_1000': [],
            #         'αFmax_5000': [],
            #         'αFmax_400': [],
            #         'vFmax_1600': [],
            #         'vHF_10k_Fmax_1000': [],
            #         'αHF_10k_Fmax_1000': [],
            #         '解调HF_10k_Fmax_1000': [],
            #         '解调HF_1-10k_Fmax_1000': [],
            #     },
            # },
            # '前期_03': {
            #     '频域': {
            #         'αFmax_1000': [],
            #         'αFmax_5000': [],
            #         'αFmax_400': [],
            #         'vFmax_1600': [],
            #         'vHF_10k_Fmax_1000': [],
            #         'αHF_10k_Fmax_1000': [],
            #         '解调HF_10k_Fmax_1000': [],
            #         '解调HF_1-10k_Fmax_1000': [],
            #     },
            #     '时域': {
            #         'αFmax_1000': [],
            #         'αFmax_5000': [],
            #         'αFmax_400': [],
            #         'vFmax_1600': [],
            #         'vHF_10k_Fmax_1000': [],
            #         'αHF_10k_Fmax_1000': [],
            #         '解调HF_10k_Fmax_1000': [],
            #         '解调HF_1-10k_Fmax_1000': [],
            #     },
            # },
            "中期": {
                "频域": {
                    "αFmax_1000": [],
                    "αFmax_5000": [],
                    "αFmax_400": [],
                    "vFmax_1600": [],
                    "vHF_10k_Fmax_1000": [],
                    "αHF_10k_Fmax_1000": [],
                    "解调HF_10k_Fmax_1000": [],
                    "解调HF_1-10k_Fmax_1000": [],
                },
                "时域": {
                    "αFmax_1000": [],
                    "αFmax_5000": [],
                    "αFmax_400": [],
                    "vFmax_1600": [],
                    "vHF_10k_Fmax_1000": [],
                    "αHF_10k_Fmax_1000": [],
                    "解调HF_10k_Fmax_1000": [],
                    "解调HF_1-10k_Fmax_1000": [],
                },
            },
            # '后期': {
            #     '频域': {
            #         'αFmax_1000': [],
            #         'αFmax_5000': [],
            #         'αFmax_400': [],
            #         'vFmax_1600': [],
            #         'vHF_10k_Fmax_1000': [],
            #         'αHF_10k_Fmax_1000': [],
            #         '解调HF_10k_Fmax_1000': [],
            #         '解调HF_1-10k_Fmax_1000': [],
            #     },
            #     '时域': {
            #         'αFmax_1000': [],
            #         'αFmax_5000': [],
            #         'αFmax_400': [],
            #         'vFmax_1600': [],
            #         'vHF_10k_Fmax_1000': [],
            #         'αHF_10k_Fmax_1000': [],
            #         '解调HF_10k_Fmax_1000': [],
            #         '解调HF_1-10k_Fmax_1000': [],
            #     },
            # },
        },
        # '垂直方向': {
        #     '前期_01': {
        #         '频域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #         '时域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #     },
        #     '前期_02': {
        #         '频域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #         '时域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #     },
        #     '前期_03': {
        #         '频域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #         '时域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #     },
        #     '中期': {
        #         '频域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #         '时域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #     },
        #     '后期': {
        #         '频域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #         '时域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #     },
        # },
        # '轴向方向': {
        #     '前期_01': {
        #         '频域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #         '时域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #     },
        #     '前期_02': {
        #         '频域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #         '时域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #     },
        #     '前期_03': {
        #         '频域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #         '时域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #     },
        #     '中期': {
        #         '频域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #         '时域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #     },
        #     '后期': {
        #         '频域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #         '时域': {
        #             'αFmax_1000': [],
        #             'αFmax_5000': [],
        #             'αFmax_400': [],
        #             'vFmax_1600': [],
        #             'vHF_10k_Fmax_1000': [],
        #             'αHF_10k_Fmax_1000': [],
        #             '解调HF_10k_Fmax_1000': [],
        #             '解调HF_1-10k_Fmax_1000': [],
        #         },
        #     },
        # },
    },
    # '泵非驱动端': {
    #     '水平方向': {
    #         '前期_01': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_02': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_03': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '中期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '后期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #     },
    #     '垂直方向': {
    #         '前期_01': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_02': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_03': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '中期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '后期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #     },
    # },
    # '电机驱动端': {
    #     '水平方向': {
    #         '前期_01': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_02': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_03': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '中期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '后期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #     },
    #     '垂直方向': {
    #         '前期_01': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_02': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_03': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '中期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '后期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #     },
    #     '轴向方向': {
    #         '前期_01': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_02': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_03': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '中期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '后期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #     },
    # },
    # '电机非驱动端': {
    #     '水平方向': {
    #         '前期_01': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_02': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_03': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '中期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '后期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #     },
    #     '垂直方向': {
    #         '前期_01': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_02': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '前期_03': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '中期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #         '后期': {
    #             '频域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #             '时域': {
    #                 'αFmax_1000': [],
    #                 'αFmax_5000': [],
    #                 'αFmax_400': [],
    #                 'vFmax_1600': [],
    #                 'vHF_10k_Fmax_1000': [],
    #                 'αHF_10k_Fmax_1000': [],
    #                 '解调HF_10k_Fmax_1000': [],
    #                 '解调HF_1-10k_Fmax_1000': [],
    #             },
    #         },
    #     },
    # },
}
key_data = extract_keys(json_data)

data = [random.random() for i in range(5000)]
for key in json_data.keys():
    dump_data(json_data, key)

start = time.time()
serializer_data = orjson.dumps(json_data)
with meta_engine.begin() as connection:
    s = text("INSERT INTO json_test (data) " "values (:data);")
    result = connection.execute(s, data=serializer_data)
end = time.time()
print((end - start))  # 5s

start = time.time()
with meta_engine.begin() as connection:
    s = text(
        'SELECT json_extract( DATA, \'$."泵非驱动端"."水平方向"."前期_01"."频域"."vFmax_1600"\') as data FROM json_test where id = 3 '
    )
    result = connection.execute(s)
    result = result.fetchone()
    result = orjson.loads(result["data"])
end = time.time()
print((end - start))

# 一级查询 3.48s   泵非驱动端 泵驱动端 这一级
# 二级查询 0.89s   水平方向 垂直方向 这一级
# 三级查询 0.21s   前期 中期 这一级
# 四级查询 0.10s   时域 频域 这一级
# 五级查询 0.04s   vFmax_1600 这一级，直接定位到某条数据
